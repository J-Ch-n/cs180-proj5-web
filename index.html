<!-- Referenced https://www.youtube.com/watch?v=i7uJAOFEd4g -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>CS180 Proj 5</title>
        <link rel="stylesheet" href="https://cdn.lineicons.com/4.0/lineicons.css" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="style.css">
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </head>

    <body>
        <div class="wrapper">
            <div id="sidebar"> 
                <div class="sidebar-logo">
                    <a href="#title">Navigation</a>
                </div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part0">
                                <span>Part A.0</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part1">
                                <span>Part A.1.1</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part2">
                                <span>Part A.1.2</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part3">
                                <span>Part A.1.3</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part4">
                                <span>Part A.1.4</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part5">
                                <span>Part A.1.5</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part6">
                                <span>Part A.1.6</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part7">
                                <span>Part A.1.7</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part8">
                                <span>Part A.1.8</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part9">
                                <span>Part A.1.9</span>
                            </a>
                        </button>
                    </li>
                </ul>
            </div>
            <!-- End of sidebar -->
             
            <div class="main">
                <h1 id="title"> CS180 Project 5 </h1>
                <h2 id="part0"> Part A.0: Setup </h2>

                <div class="text-container"> 
                    <h3>An oil painting of a snowy mountain village</h3>

                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_0_image_inf_4.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 4
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_0_image_inf_10.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 10
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_0_image_inf_20.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 20
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_0_image_inf_4.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 4
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_0_image_inf_10.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 10
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_0_image_inf_20.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 20
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <p> 
                        The prompt for this image was "an oil painting of a snowy mountain village." All of them are relavent to the prompt. However, the more inference steps it 
                        had, the more detailed and less impressionistic the image was. For example, the 4-step inference yielded a very sureal impression of a village, while the 20-step
                        inference yielded a more defined and vibrant version of the same idea. The 10-step inference was somewhere in between. Stage 2 upsampled the outputs of stage 1 images 
                        to get much clearer images.
                    </p>

                    <h3>A man wearing a hat</h3>
                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_1_image_inf_4.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 4 
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_1_image_inf_10.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 10 
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_1_image_inf_20.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 20 
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_1_image_inf_4.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 4 
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_1_image_inf_10.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 10 
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_1_image_inf_20.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 20 
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <p> 
                        The prompt for this image was "a man wearing a hat." All of them seem to be relavent to the prompt. However, the more inference steps it 
                        had, the more detailed and realistic the image was. For example, the 4-step inference yielded an altervative depiction of the prompt, while the 20-step
                        inference yielded a very detailed and almost photographic version of the same idea. The 10-step inference was somewhere in between. Stage 2 upsampled the outputs of stage 1 images 
                        to get much clearer images.
                    </p>

                    <h3>A rocket ship</h3>

                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_2_image_inf_4.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 4 
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_2_image_inf_10.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 10 
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage1_2_image_inf_20.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 20 
                                    <br/>
                                    Stage 1
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_2_image_inf_4.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 4 
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_2_image_inf_10.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 10 
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 0/stage2_2_image_inf_20.jpg", width="200">
                                <figcaption class="caption"> 
                                    Inference steps: 20 
                                    <br/>
                                    Stage 2
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <p>
                        The prompt for this image was "a rocket ship." The 4-step inference didn't yield anything obviously relavent to the promop (maybe I don't know too much about rocket ships), while the 20-step
                        inference yielded a realistic drawing of a rocket ship. The 10-step inference was somewhere in between, having yielded a hybrid between a traditional rocket ship and a bat. 
                        Similar to the previous two prompts, stage 2 upsampled the outputs of stage 1 images to get much clearer images.
                    </p>
                    <p> 
                        I'm using seed = 22 for this problem.
                    </p>
                
                </div>
                <h2 id="part1"> Part A.1.1: Implementing the Forward Process</h2>

                <div class="text-container"> 
                    <p> 
                        To add noises, we follow the following formula:
                        \[
                        q(x_t | x_0) = N(x_t ; \sqrt{\bar\alpha} x_0, (1 - \bar\alpha_t)\mathbf{I})
                        \]
                        After simplification, we arrive at the following equivlaent form:
                        \[
                        x_t = \sqrt{\bar\alpha_t} x_0 + \sqrt{1 - \bar\alpha_t} \epsilon \quad \text{where}~ \epsilon \sim N(0, 1) \tag{0}
                        \]
                        This means that we need to sample from a standard normal distribution and call it \( \epsilon \). For each \(\bar\alpha_t\) from 
                        the alphas_cumprod variable from the scheduler, indexed by t, we iteratively add noises to our clean image. 
                        Here, we display the Campanile with noises added at \(t \in [250, 500, 750]\):
                    </p>  

                    <p> 
                        I'm using seed = 22 for this problem. However, for some sections, I need to use different seeds to ensure the quality and reproducibility of the results.
                    </p>
                    
                    <div class="single_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image.jpg", width="200">
                                <figcaption class="caption"> 
                                    Berkeley Campanile
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_nl_250.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=250
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_nl_500.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=500
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_nl_750.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=750
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>
                <!-- End of A.1.1-->
                <h2 id="part2"> Part A.1.2: Classical Denoising</h2>

                <div class="text-container"> 
                    <p> 
                       In this section, I attempted to use classical methods to denoise the test images from the previous part.
                       I used torchvision.transforms.functional.gaussian_blur (kernel = 9, sigma = 2) in order to get the denoised versions of the images. 
                       The results are not satisfactory at all, especially the for the image with larger t.
                    </p>  

                    <p> 
                        I'm using seed = 22 for this problem.
                    </p>
                

                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_nl_250.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=250
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_nl_500.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=500
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_nl_750.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=750
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_denoise_250_k_9_s_2.jpg", width="200">
                                <figcaption class="caption"> 
                                    Gaussian Blur Denoising <br/> at t=250
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_denoise_500_k_9_s_2.jpg", width="200">
                                <figcaption class="caption"> 
                                    Gaussian Blur Denoising <br/> at t=500
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_denoise_750_k_9_s_2.jpg", width="200">
                                <figcaption class="caption"> 
                                    Gaussian Blur Denoising <br/> at t=750
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>  
                <!-- End of A.1.2-->  
                <h2 id="part3"> Part A.1.3: One-Step Denoising</h2>

                <div class="text-container"> 
                    <p> 
                       In this section, I attempted to denoise the noisy test images using a the pretrained unet. The unet will 
                       estimate both the noise of the current time step. I passed in the noisy image, the time step t, and the prompt embedding into the unet, after which 
                       I used output to reconstruct the denoised image using the following formula.

                       \[
                        x_0 = \frac{x_t - \sqrt{1 - \bar{\alpha}_t} \epsilon}{\sqrt{\bar{\alpha}_t}} \tag{1}
                       \]

                       where \(x_0\) is the clean image, \(x_t\) is the noisy image, \(\epsilon\) is the estimated noise, 
                       and \(\bar{\alpha}_t\) is the alphas_cumprod variable from the scheduler, indexed by t.

                       The following are the results from the denoisign process.
                    </p>  

                    <p> 
                        I'm using seed = 22 for this problem.
                    </p>
                
                    <div class="single_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image.jpg", width="200">
                                <figcaption class="caption"> 
                                    Berkeley Campanile
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <div class="three_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_noise_est_250.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=250
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_noise_est_500.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=500
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_noise_est_750.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=750
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_unet_denoise_250.jpg", width="200">
                                <figcaption class="caption"> 
                                    One-Step Denoised Campanile<br/> at t=250
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_unet_denoise_500.jpg", width="200">
                                <figcaption class="caption"> 
                                    One-Step Denoised Campanile<br/> at t=500
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image_unet_denoise_750.jpg", width="200">
                                <figcaption class="caption"> 
                                    One-Step Denoised Campanile<br/> at t=750
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>  
                <!-- End of A.1.3-->  
                <h2 id="part4"> Part A.1.4:  Iterative Denoising</h2>

                <div class="text-container"> 
                    <p> 
                       In this section, I used iterative denoising to achieve more optimal results than one-step denoising. I started with the most noisy time step, \(T = 990\) and iteratively
                       denoised the image with the stride size of -30 until T reached 0. The list of Ts are in the variable called strided timesteps. 

                       In a for loop, I looped through each value of strided timesteps and denoised the image for each time step t. 

                       The algorithm is as follows:
                    </p>  

                    <p> 
                        For each t, I used the following formula to reconstruct the denoised image at that time step.

                        \[
                        x_{t'} = \frac{\sqrt{\bar\alpha_{t'}}\beta_t}{1 - \bar\alpha_t} x_0 +
                        \frac{\sqrt{\alpha_t}(1 - \bar\alpha_{t'})}{1 - \bar\alpha_t} x_t +
                        v_\sigma \tag{2}
                        \]

                        Where:
                    </p>
                    <ul>
                        <li><strong>\( t' \):</strong> The previous (index + 1) time step relative to the current time step \( t \).</li>
                        <li><strong>\( \bar{\alpha}_{t'} \):</strong> The cumulative product found in alphas_cumprod at time step \( t' \).</li>
                        <li><strong>\( x_{t'} \):</strong> The denoised image at time step \( t' \).</li>
                        <li><strong>\( \bar{\alpha}_t \):</strong> The cumulative product found in alphas_cumprod at time step \( t \).</li>
                        <li><strong>\( \alpha_t \):</strong> \(\frac{\bar\alpha_t}{\bar\alpha_{t'}}\)</li>
                        <li><strong>\( \beta_t \):</strong> \(1 - \alpha_t\)</li> 
                        <li><strong>\( x_t \):</strong> The noisy image at time step \( t \).</li>
                        <li><strong>\( x_0 \):</strong> The current state of the cleaned image at time step \( t \), retrieved using equation (1). </li>
                        <li><strong>\( v_\sigma \):</strong> The predicted noise variance form the unet.</li>
                    </ul>

                    <p> Specific details about implementation: 
                        <ul>
                            <li> I used <code>add_variance</code> function to add the predicted variance from the unet to the denoised image.</li>
                            <li> I used <code>i_start = 10</code> as the starting time step.</li>
                            <li> I used the estimated noise from the unet as \(\epsilon\) in equation (1) to get \( x_0 \).</li>
                        </ul>
                    </p>

                    <p> 
                        I'm using seed = 22 for this problem. Here are the results.
                    </p>
                
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image.jpg", width="200">
                                <figcaption class="caption"> 
                                    Berkeley Campanile Original
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/iter/test_image_iter_clean_final.jpg", width="200">
                                <figcaption class="caption"> 
                                    Iteratively Denoised Campanile
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/iter/test_image_iter_clean_one_step.jpg", width="200">
                                <figcaption class="caption"> 
                                    One-Step Denoised Campanile
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/iter/test_image_gaus.png", width="200">
                                <figcaption class="caption"> 
                                    Gaussian Blurred Campanile
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/iter/test_image_iter_unet_denoise_90.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=90
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/iter/test_image_iter_unet_denoise_240.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=240
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/iter/test_image_iter_unet_denoise_390.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=390
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/iter/test_image_iter_unet_denoise_540.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=540
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/iter/test_image_iter_unet_denoise_690.jpg", width="200">
                                <figcaption class="caption"> 
                                    Noisy Campanile at t=690
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>  
                <!-- End of A.1.4-->  
                <h2 id="part5"> Part A.1.5: Diffusion Model Sampling</h2>

                <div class="text-container"> 
                    <p> 
                       In this section, used the trained unet diffusion model to denoise pure noise with the embedded guidance of "a high quality photo". To denoise images from random
                       noises, I set <code>i_start = 0</code> and passed in a random noise, sampled from a standard normal distribution, with the shape of (5, 1, 64, 64), five images sampled at once. The model sampling/ reconstruction loop is the same as A.1.4.
                    </p>

                    <p> 
                        Though the following sampled images are not very good, they are decent in quality.
                    </p>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/img_0.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/img_1.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 2
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/img_2.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/img_3.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 4
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/img_4.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 5
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>  
                <!-- End of A.1.5-->  
                <h2 id="part6"> Part A.1.6: Classifier-Free Guidance (CFG)</h2>

                <div class="text-container"> 
                    <p> 
                       In this section, I used classifier-free guidance to improve the quality of the denoised images. The CFG algorithm involves running the unet model twice, once as an unconditional unet and once as a conditional unet.
                       I used the null prompt, '', as the embedded prompt for the unconditional unet and the original prompt, 'a high quality photo', as the embedded prompt for the conditional unet. The output of the unconditional unet is called
                       \(\epsilon_u\) and the output of the conditional unet is called \(\epsilon_c\). Using the equation below, I got the final noise at the current time step.

                    <p> 
                     \[
                     \epsilon = \epsilon_u + \gamma
                     (\epsilon_c - \epsilon_u) \tag{3}
                     \]
                    </p>

                    <p> 
                        \(\gamma\) is the guidance scale, a variable that controlls how much guidance the final noise receives. When \(\gamma = 1\), the estimated noise is purely conditional, while when \(\gamma = 0\), the estimated noise is purely unconditional.
                        To make the magic happen, I set \(\gamma = 7\) per the spec's recommendation.
                    </p>

                    <p> 
                        After getting the guided estimated noise, the rest of the image denoising process is the same as A.1.5. Here are 5 samples from the iterative denoising process with CFG. I would say they are of much higher quality (clearer and more vibrant) than the samples from the previous section.
                    </p>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/cfg_img_0.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/cfg_img_1.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 2
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/cfg_img_2.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/cfg_img_3.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 4
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/cfg_img_4.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 5
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>  
                <!-- End of A.1.6-->  
                <h2 id="part7"> Part A.1.7: Image-to-image Translation </h2>

                <div class="text-container"> 
                    <p> 
                        In this section I used the SDEdit algorithm to iteratively guide, CFG, the noisy image back to its something resembling the original image. To do so, I followed the following steps:
                    <p> 
                    
                    <ul>
                        <li> I added noise to the chosen image by running the forward method outlined in equation (0). </li>
                        <li> I then used "a high quality photo" as the embedded prompt to guide the denoising process at time steps [1, 3, 5, 7, 10, 20]. </li>
                        <li> I applied these two steps on the test image and two other images of my choice. </li>
                        <li> The <B>seed</B> is 100 for all three images.</li>
                    </ul>

                    <p> Test Image SDEdit: </p>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_test_1.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 1</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_test_3.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 3</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_test_5.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 5</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_test_7.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 7</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_test_10.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 10</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_test_20.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 20</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image.jpg", width="130">
                                <figcaption class="caption"> 
                                    Original Image <br/>
                                    Berkeley Campanile
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <p> Burney Fall SDEdit: </p>
                    
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_fall_1.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 1</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_fall_3.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 3</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_fall_5.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 5</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_fall_7.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 7</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_fall_10.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 10</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_fall_20.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 20</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/data/small/fall.jpeg", width="130">
                                <figcaption class="caption"> 
                                    Original Image <br/>
                                    Burney Fall
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <p> Yosemite SDEdit: </p>
                    
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_yosemite_1.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 1</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_yosemite_3.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 3</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_yosemite_5.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 5</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_yosemite_7.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 7</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_yosemite_10.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 10</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/sampling/sde_cfg_yosemite_20.jpg", width="130">
                                <figcaption class="caption"> 
                                    SDEdit with <br/> 
                                    <code>i_start = 20</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/data/small/yosemite.jpeg", width="130">
                                <figcaption class="caption"> 
                                    Original Image <br/>
                                    Yosemite
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>  
                <!-- End of A.1.7-->  
                <h2> Part A.1.7.1: Editing Hand-Drawn and Web Images </h2>

                <div class="text-container"> 
                    <p> 
                       Now it's time to apply the SDEdit technique to web images and hand-drawn images. To do so, I downloaded one web image and drew 2 images by hand, after which I applied the same procedure as the previous part and recorded the results and 
                       intermediate images.
                    <p> 

                    <p> Kangaroo (Web) SDEdit: 
                        <br/>
                        <a href="https://c02.purpledshub.com/uploads/sites/62/2024/07/kangaroo-facts.jpg?w=1029&webp=1">Kangaroo Image Link</a>
                    </p>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/kangaroo_start_1.jpg", width="130">
                                <figcaption class="caption"> 
                                    Kangaroo at <br/> 
                                    <code>i_start = 1</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/kangaroo_start_3.jpg", width="130">
                                <figcaption class="caption"> 
                                    Kangaroo at <br/> 
                                    <code>i_start = 3</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/kangaroo_start_5.jpg", width="130">
                                <figcaption class="caption"> 
                                    Kangaroo at <br/> 
                                    <code>i_start = 5</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/kangaroo_start_7.jpg", width="130">
                                <figcaption class="caption"> 
                                    Kangaroo at <br/> 
                                    <code>i_start = 7</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/kangaroo_start_10.jpg", width="130">
                                <figcaption class="caption"> 
                                    Kangaroo at <br/> 
                                    <code>i_start = 10</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/kangaroo_start_20.jpg", width="130">
                                <figcaption class="caption"> 
                                    Kangaroo at <br/> 
                                    <code>i_start = 20</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/data/small/kangaroo.jpg", width="130">
                                <figcaption class="caption"> 
                                    Original Image <br/>
                                    Kangaroo
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <p> Hand-drawn Leaf SDEdit: </p>
                    
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/leaf_1.jpg", width="130">
                                <figcaption class="caption"> 
                                    Leaf at <br/> 
                                    <code>i_start = 1</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/leaf_3.jpg", width="130">
                                <figcaption class="caption"> 
                                    Leaf at <br/> 
                                    <code>i_start = 3</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/leaf_5.jpg", width="130">
                                <figcaption class="caption"> 
                                    Leaf at <br/> 
                                    <code>i_start = 5</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/leaf_7.jpg", width="130">
                                <figcaption class="caption"> 
                                    Leaf at <br/> 
                                    <code>i_start = 7</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/leaf_10.jpg", width="130">
                                <figcaption class="caption"> 
                                    Leaf at <br/> 
                                    <code>i_start = 10</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/leaf_20.jpg", width="130">
                                <figcaption class="caption"> 
                                    Leaf at <br/> 
                                    <code>i_start = 20</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/drawn_leaf.jpg", width="130">
                                <figcaption class="caption"> 
                                    Original Image <br/>
                                    Hand-drawn Leaf
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <p> Hand-drawn Tree SDEdit: </p>
                    
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/tree_1.jpg", width="130">
                                <figcaption class="caption"> 
                                    Tree at <br/> 
                                    <code>i_start = 1</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/tree_3.jpg", width="130">
                                <figcaption class="caption"> 
                                    Tree at <br/> 
                                    <code>i_start = 3</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/tree_5.jpg", width="130">
                                <figcaption class="caption"> 
                                    Tree at <br/> 
                                    <code>i_start = 5</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/tree_7.jpg", width="130">
                                <figcaption class="caption"> 
                                    Tree at <br/> 
                                    <code>i_start = 7</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/tree_10.jpg", width="130">
                                <figcaption class="caption"> 
                                    Tree at <br/> 
                                    <code>i_start = 10</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/tree_20.jpg", width="130">
                                <figcaption class="caption"> 
                                    Tree at <br/> 
                                    <code>i_start = 20</code>
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hand-web/drawn_tree.jpg", width="130">
                                <figcaption class="caption"> 
                                    Original Image <br/>
                                    Hand-drawn Tree
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>  
                <!-- End of A.1.7.1-->  

                <h2 id="part7.2"> Part 1.7.2 Inpainting </h2>

                <div class="text-container">
                    <p> 
                        To allow inpainting, we use a binary mask to allow new image to be painted when the mask is 1 and keeps the original image's noises when the mask is 0. 
                        To achieve this effect we need to use the following equation after we get the denoised image \( x_t \) at each time step \( t \).
                    <p> 
                        \[
                        x_t \leftarrow \textbf{m} x_t + (1 - \textbf{m})
                        \text{forward}(x_{orig}, t) \tag{4}
                        \]
                        Where: 
                        <ul>
                            <li>\( x_t \): The denoised image at time step \( t \).</li>
                            <li>\( x_{orig} \): The original image.</li>
                            <li>\( \textbf{m} \): The binary mask.</li>
                        </ul>
                    </p>

                    <p> Here are the results from the inpainting process. </p>
                    
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/test_og.jpg", width="200">
                                <figcaption class="caption"> 
                                    Campanile
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/test_mask.jpg", width="200">
                                <figcaption class="caption"> 
                                    Mask
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/test_replace.jpg", width="200">
                                <figcaption class="caption"> 
                                    Hole to Fill
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/test_clean.jpg", width="200">
                                <figcaption class="caption"> 
                                    Campanile Inpainted (Seed = 2)
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/hat_og.jpg", width="200">
                                <figcaption class="caption"> 
                                    Hat
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/hat_mask.jpg", width="200">
                                <figcaption class="caption"> 
                                    Mask
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/hat_replace.jpg", width="200">
                                <figcaption class="caption"> 
                                    Hole to Fill
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/hat_clean.jpg", width="200">
                                <figcaption class="caption"> 
                                    Hat Inpainted (Seed = 9912)
                                </figcaption>
                            </figure>
                        </div>
                    </div>
            
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/chick_og.jpg", width="200">
                                <figcaption class="caption"> 
                                    Proud Snackpass Chick
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/chick_mask.jpg", width="200">
                                <figcaption class="caption"> 
                                    Mask
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/chick_replace.jpg", width="200">
                                <figcaption class="caption"> 
                                    Hole to Fill
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/inpaint/chick_clean.jpg", width="200">
                                <figcaption class="caption"> 
                                    Chick Inpainted (Seed = 900)
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>
                <!-- End of A.1.7.2-->  
                <h2 id="part7.3"> Part 1.7.3 Text-Conditioned Image-to-image Translation </h2>

                <div class="text-container">
                    <p> 
                        The text-conditioned image-to-image translation requires us to change the conditioning prompt from "a high quality photo" to any of the given prompts. 
                        For this section, I used "a rocket ship" for the test image, "a lithograph of a river" for the Yosemite image, and "a rocket ship" for the street light image.
                    </p> 

                    <p> Here are the results using text-conditioning with <B>seed</B> = 100. </p>
                    
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/rocket_noise_1.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket Ship at noise 
                                    <br/> 
                                    level 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/rocket_noise_3.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket Ship at noise 
                                    <br/> 
                                    level 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/rocket_noise_5.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket Ship at noise 
                                    <br/> 
                                    level 5
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/rocket_noise_7.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket Ship at noise 
                                    <br/> 
                                    level 7
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/rocket_noise_10.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket Ship at noise 
                                    <br/> 
                                    level 10
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/rocket_noise_20.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket Ship at noise 
                                    <br/> 
                                    level 20
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/test_image.jpg", width="150">
                                <figcaption class="caption"> 
                                    Original Image 
                                    <br/>
                                    Campanile
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/fall_clean_1.jpg", width="150">
                                <figcaption class="caption"> 
                                    River at noise 
                                    <br/> 
                                    level 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/fall_clean_3.jpg", width="150">
                                <figcaption class="caption"> 
                                    River at noise 
                                    <br/> 
                                    level 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/fall_clean_5.jpg", width="150">
                                <figcaption class="caption"> 
                                    River at noise 
                                    <br/> 
                                    level 5
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/fall_clean_7.jpg", width="150">
                                <figcaption class="caption"> 
                                    River at noise 
                                    <br/> 
                                    level 7
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/fall_clean_10.jpg", width="150">
                                <figcaption class="caption"> 
                                    River at noise 
                                    <br/> 
                                    level 10
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/fall_clean_20.jpg", width="150">
                                <figcaption class="caption"> 
                                    River at noise 
                                    <br/> 
                                    level 20
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/data/small/yosemite.jpeg", width="150">
                                <figcaption class="caption"> 
                                    Original Image 
                                    <br/>
                                    Yosemite
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/light_clean_1.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket (Light) at noise 
                                    <br/> 
                                    level 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/light_clean_3.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket (Light) at noise 
                                    <br/> 
                                    level 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/light_clean_5.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket (Light) at noise 
                                    <br/> 
                                    level 5
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/light_clean_7.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket (Light) at noise 
                                    <br/> 
                                    level 7
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/light_clean_10.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket (Light) at noise 
                                    <br/> 
                                    level 10
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/text-cond/light_clean_20.jpg", width="150">
                                <figcaption class="caption"> 
                                    Rocket (Light) at noise 
                                    <br/> 
                                    level 20
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/data/small/light.jpeg", width="150">
                                <figcaption class="caption"> 
                                    Original Image 
                                    <br/>
                                    Street Light
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>
                <!-- End of A.1.7.3--> 
                <h2 id="part8"> Part A.1.8: Visual Anagrams</h2>

                <div class="text-container"> 
                    <p> 
                        <B>TODO</B>
                    </p>

                    <p>
                        \[
                        \epsilon_1 = \text{UNet}(x_t, t, p_1)
                        \]
                        \[
                        \epsilon_2 = \text{flip}(\text{UNet}(\text{flip}(x_t), t, p_2))
                        \]
                        \[
                        \epsilon = (\epsilon_1 + \epsilon_2) / 2
                        \]
                    </p>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/anagram/man_village.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/anagram/man_village.jpg", width="200", style="transform: scaleY(-1);">
                                <figcaption class="caption"> 
                                    Sample 2
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/anagram/village_fire.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/anagram/village_fire.jpg", width="200", style="transform: scaleY(-1);">
                                <figcaption class="caption"> 
                                    Sample 2
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/anagram/man_fire.jpg", width="200">
                                <figcaption class="caption"> 
                                    Sample 1
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/anagram/man_fire.jpg", width="200", style="transform: scaleY(-1);">
                                <figcaption class="caption"> 
                                    Sample 2
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                </div>  
                <!-- End of A.1.8--> 
                
                <h2 id="part8"> Part A.1.9: Hybrid Images</h2>

                <div class="text-container"> 
                    <p> 
                        <B>TODO</B>
                    </p>

                    <p>
                        \[
                        \epsilon_1 = \text{UNet}(x_t, t, p_1)
                        \]
                        \[
                        \epsilon_2 = \text{UNet}(x_t, t, p_2)
                        \]
                        \[
                        \epsilon = f_\text{lowpass}(\epsilon_1) + f_\text{highpass}(\epsilon_2)
                        \]
                    </p>

                    <div class="linear"> 
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hybrid/skull_fall.jpg", width="200">
                                <figcaption class="caption"> 
                                    Hybrid image of <br/> 
                                    a skull and a waterfall
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hybrid/skull_camp.jpg", width="200">
                                <figcaption class="caption"> 
                                    Hybrid image of 
                                    <br/> 
                                    a skull and a campfire
                                </figcaption>
                            </figure>
                        </div>
                        <div class=image>
                            <figure> 
                                <img src="data_A/part 1/hybrid/skull_forest.jpg", width="200">
                                <figcaption class="caption"> 
                                    Hybrid image of 
                                    <br/> 
                                    a skull and a forest
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>  
                <!-- End of A.1.9--> 
            </div>
        </div>
    </body>
</html>
